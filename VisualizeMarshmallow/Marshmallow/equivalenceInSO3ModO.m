function [zs,ds,inds,a3a1InCenter] = equivalenceInSO3ModO(a3a1, a3a2)
    n = size(a3a1,1);

    rots = ...
    [[1 0 0 0];...
    [0 0 1 pi/2];...
    [0 1 0 pi/2];...
    [1 0 0 pi/2];...
    [0 0 1 -pi/2];...
    [0 1 0 -pi/2];...
    [1 0 0 -pi/2];...
    [1 1 1 2*pi/3];...
    [1 1 -1 2*pi/3];...
    [1 -1 1 2*pi/3];...
    [1 -1 -1 2*pi/3];...
    [-1 1 1 2*pi/3];...
    [-1 1 -1 2*pi/3];...
    [-1 -1 1 2*pi/3];...
    [-1 -1 -1 2*pi/3];...
    [1 1 0 pi];...
    [1 0 1 pi];...
    [0 1 1 pi];...
    [1 -1 0 pi];...
    [1 0 -1 pi];...
    [0 1 -1 pi];...
    [-1 1 0 pi];...
    [-1 0 1 pi];...
    [0 -1 1 pi];...
    [-1 -1 0 pi];...
    [-1 0 -1 pi];...
    [0 -1 -1 pi]...
    ];
    nrots = size(rots,1);
    rotQ = axang2quat(rots);
    
    B = repmat(rotQ,1,n)';
    B = reshape(B,4,[])';
    
    Q1 = axang2quat([a3a1 sqrt(sum(a3a1.*a3a1,2))]);
    Q2 = axang2quat([a3a2 sqrt(sum(a3a2.*a3a2,2))]);
    Q1(find(Q1~=Q1))=0;
    Q2(find(Q2~=Q2))=0;
    
    Trots = quatmultiply(B, repmat(Q1, nrots, 1));
    aadiffs = quat2axang(quatmultiply(repmat(quatinv(Q2), nrots,1), Trots));
    AAD = abs(aadiffs(:,4));
    AAD = reshape(AAD,n,[])';
    
    [ds, inds]=min(AAD);
    ds = ds'; inds = inds';
    zs = ds < .000001;
    
    if nargout >= 4
        AA = quat2axang(quatmultiply( rotQ(inds,:), Q1 ));
        a3a1InCenter = AA(:,1:3).*AA(:,4);
    end
    
    
end